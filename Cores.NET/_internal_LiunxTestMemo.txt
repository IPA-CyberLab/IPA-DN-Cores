dn-lxd-vm2-test1
root

======== Git ========
■ 初回
cd ~/ && rm -fr ~/IPA-DN-Cores/
git clone --recursive git@github.com:IPA-CyberLab/IPA-DN-Cores.git


■ 2 回目以降
cd ~/IPA-DN-Cores/Cores.NET/TestDev/ && (cd ../../ && git pull origin master && git submodule update --init --recursive) && dotnet run


■ Web サーバーテスト
cd ~/IPA-DN-Cores/Cores.NET/SampleProjects/AspNetCore1/AspNetCore1/ && (cd ../../ && git pull origin master && git submodule update --init --recursive) && dotnet run


■ どのディレクトリからでも呼べる更新コマンド
(cd ~/IPA-DN-Cores/ && git pull origin master && git submodule update --init --recursive)


======== 簡易コピー ========
cd ~/ && rm -fr ~/Copy-IPA-DN-Cores-Copy/


_internal_CopyToTestLXDContainer.cmd


cd ~/Copy-IPA-DN-Cores/Cores.NET/TestDev/ && dotnet run test

Web サーバーテスト

cd ~/Copy-IPA-DN-Cores/Cores.NET/SampleProjects/AspNetCore1/AspNetCore1/ && rm -fr bin/ && dotnet run daemon test


ベンチマーク

cd ~/Copy-IPA-DN-Cores/Cores.NET/TestDev/ && dotnet run -c Release BenchMark



プロファイリング

cd ~/IPA-DN-Cores/Cores.NET/TestDev/
COMPlus_PerfMapEnabled=1 dotnet run net
pid を調べる
ps auxf | grep -i "dotnet exec"

cd ~/IPA-DN-Cores/Cores.NET/TestDev/
perf record -p 1115305 -g

Ctrl+C

perf report -f


メモ lxd-vm2

lxc config set dn-lxd-vm2-test1 limits.memory 8000MB
lxc config set dn-lxd-vm2-test1 limits.cpu 20

lxc config unset dn-lxd-vm2-test1 limits.memory
lxc config unset dn-lxd-vm2-test1 limits.cpu




gdb

gdb /usr/bin/dotnet

run exec /root/Copy-IPA-DN-Cores/Cores.NET/TestDev/bin/Debug/netcoreapp2.1/TestDev.dll net

strace /usr/bin/dotnet exec /root/Copy-IPA-DN-Cores/Cores.NET/TestDev/bin/Debug/netcoreapp2.1/TestDev.dll net



ストレステスト クライアント

cd ~/Copy-IPA-DN-Cores/Cores.NET/TestDev/ && rm -fr bin/ && perl -pi -e 's/netcoreapp2\.1/netcoreapp2\.2/g' TestDev.csproj && dotnet run TcpStressServer

